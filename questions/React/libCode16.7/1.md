# 16.7-(1)

<!-- https://zhuanlan.zhihu.com/p/55443842 -->

## react.createElement

```js
import React from 'react';
import ReactDOM from 'react-dom';
ReactDOM.render(
    <h1>DEMO</h1>,
    // <h1 style={{color: 'red'}} data-url='123123'>DEMO</h1>
    document.getElementById('root')
);
```

createElement这个函数做了什么

1. 初始化一些变量，之后会判断我们传入的元素中是否带有key和ref的属性，这两个属性对于react是有特殊意义的，如果检测到有传入key,ref,__self,__source这4个属性值，会将其保存起来。
2. 之后对传入的config做处理，循环config对象，并且剔除掉4个内置属性值（key,ref,__self,__source），之后重新组装新的config为props
3. 之后会检测传入的参数的长度，如果childrenLength等于1的情况下，那么就代表着当前createElement的元素没有子元素，只有文字或者是空，那么将内容赋值到props.children。如果childrenLength大于1，即元素涉及到嵌套子元素的时候，那么children将会有多个传入到createElement函数中。
4. 接着函数将会检测是否存在defaultProps这个参数
5. 检测key和ref是否有赋值，如果有将会执行defineKeyPropWarningGetter和defineRefPropWarningGetter两个函数
6. 最后将一系列组装好的数据传入ReactElement函数中

### defineKeyPropWarningGetter - defineRefPropWarningGetter

```js
function defineKeyPropWarningGetter(props, displayName) {
    var warnAboutAccessingKey = function () {
        if (!specialPropKeyWarningShown) {
            specialPropKeyWarningShown = true;
            warningWithoutStack$1(false, '%s: `key` is not a prop. Trying to access it will result ' + 'in `undefined` being returned. If you need to access the same ' + 'value within the child component, you should pass it as a different ' + 'prop. (https://fb.me/react-special-props)', displayName);
        }
    };
    warnAboutAccessingKey.isReactWarning = true;
    Object.defineProperty(props, 'key', {
        get: warnAboutAccessingKey,
        configurable: true
    });
}

function defineRefPropWarningGetter(props, displayName) {
    var warnAboutAccessingRef = function () {
        if (!specialPropRefWarningShown) {
            specialPropRefWarningShown = true;
            warningWithoutStack$1(false, '%s: `ref` is not a prop. Trying to access it will result ' + 'in `undefined` being returned. If you need to access the same ' + 'value within the child component, you should pass it as a different ' + 'prop. (https://fb.me/react-special-props)', displayName);
        }
    };
    warnAboutAccessingRef.isReactWarning = true;
    Object.defineProperty(props, 'ref', {
        get: warnAboutAccessingRef,
        configurable: true
    });
}
```

